<view class="game-container">
  <!-- 游戏状态栏 -->
  <view class="game-status-bar">
    <view class="player-info {{currentPlayer === 1 ? 'active' : ''}}">
      <view class="player-avatar black-stone"></view>
      <text class="player-name">玩家</text>
      <text class="player-time">{{formatTime(timer.black)}}</text>
    </view>
    
    <view class="game-info">
      <text class="move-count">第{{moveHistory.length + 1}}手</text>
      <text class="game-mode">{{gameMode === 'ai' ? '人机对战' : gameMode === 'online' ? '在线对战' : '好友对战'}}</text>
    </view>
    
    <view class="player-info {{currentPlayer === 2 ? 'active' : ''}}">
      <text class="player-time">{{formatTime(timer.white)}}</text>
      <text class="player-name">{{gameMode === 'ai' ? 'AI' : '对手'}}</text>
      <view class="player-avatar white-stone"></view>
    </view>
  </view>

  <!-- 棋盘区域 -->
  <view class="board-container">
    <chessboard 
      board="{{game.board}}" 
      currentPlayer="{{currentPlayer}}"
      lastMove="{{lastMove}}"
      hintMove="{{hintMove}}"
      gameStatus="{{gameStatus}}"
      bind:boardTap="onBoardTap">
    </chessboard>
    
    <!-- AI思考中指示器 -->
    <view class="thinking-indicator" wx:if="{{isThinking}}">
      <view class="thinking-spinner"></view>
      <text class="thinking-text">AI思考中...</text>
    </view>
    
    <!-- 游戏结果弹窗 -->
    <view class="result-modal" wx:if="{{showResult}}">
      <view class="result-content">
        <view class="result-icon {{winner === 1 ? 'win' : 'lose'}}">
          <text class="result-emoji">{{winner === 1 ? '🎉' : '😔'}}</text>
        </view>
        <text class="result-title">{{winner === 1 ? '恭喜你获胜！' : '很遗憾失败了'}}</text>
        <text class="result-subtitle">{{winner === 1 ? '继续保持！' : '再接再厉！'}}</text>
        
        <view class="result-stats">
          <view class="stat-item">
            <text class="stat-label">对局时长</text>
            <text class="stat-value">{{formatTime(Math.floor((Date.now() - gameStartTime) / 1000))}}</text>
          </view>
          <view class="stat-item">
            <text class="stat-label">总手数</text>
            <text class="stat-value">{{moveHistory.length}}</text>
          </view>
        </view>
        
        <view class="result-actions">
          <button class="btn-restart" bindtap="onRestart">再来一局</button>
          <button class="btn-back" bindtap="onBackHome">返回主页</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 游戏控制栏 -->
  <view class="game-control-bar">
    <view class="control-item" bindtap="onUndo">
      <text class="control-icon">↶</text>
      <text class="control-text">悔棋</text>
    </view>
    
    <view class="control-item" bindtap="onHint">
      <text class="control-icon">💡</text>
      <text class="control-text">提示</text>
    </view>
    
    <view class="control-item" bindtap="onPause" wx:if="{{gameStatus === 'playing'}}">
      <text class="control-icon">⏸</text>
      <text class="control-text">暂停</text>
    </view>
    
    <view class="control-item" bindtap="onResume" wx:if="{{gameStatus === 'paused'}}">
      <text class="control-icon">▶</text>
      <text class="control-text">继续</text>
    </view>
    
    <view class="control-item" bindtap="onSurrender">
      <text class="control-icon">🏳</text>
      <text class="control-text">认输</text>
    </view>
    
    <view class="control-item" bindtap="onShowMenu">
      <text class="control-icon">☰</text>
      <text class="control-text">菜单</text>
    </view>
  </view>

  <!-- 弹出菜单 -->
  <view class="popup-menu" wx:if="{{showMenu}}" bindtap="onShowMenu">
    <view class="menu-content" catchtap="true">
      <view class="menu-item" bindtap="onRestart">
        <text class="menu-icon">🔄</text>
        <text class="menu-text">重新开始</text>
      </view>
      <view class="menu-item" bindtap="onShareGame">
        <text class="menu-icon">📤</text>
        <text class="menu-text">分享对局</text>
      </view>
      <view class="menu-item" bindtap="onBackHome">
        <text class="menu-icon">🏠</text>
        <text class="menu-text">返回主页</text>
      </view>
      <view class="menu-item" bindtap="onShowMenu">
        <text class="menu-icon">✕</text>
        <text class="menu-text">取消</text>
      </view>
    </view>
  </view>

  <!-- 暂停遮罩 -->
  <view class="pause-overlay" wx:if="{{gameStatus === 'paused'}}">
    <view class="pause-content">
      <text class="pause-title">游戏暂停</text>
      <text class="pause-subtitle">点击继续按钮恢复游戏</text>
      <button class="btn-continue" bindtap="onResume">继续游戏</button>
    </view>
  </view>
</view>